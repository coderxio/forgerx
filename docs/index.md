# Documentation

This is documentation for the Medication Diversification Tool (MDT).

## Getting started

If this is your first time using the repo, the first thing you will need to do is create the `MDT.db` database.
1. Run `meps_data_reader.py` to load MEPS data
2. Run `rxnorm_data_reader.py` to load RxNorm data

You should see a `/data` directory get generated with a `MDT.db` file inside.

### Working with MDT.db

You can download `MDT.db` and query it with [DBeaver](https://dbeaver.io/) or connect with it however you normall work with SQLite files.

### Running the main MDT script

Once the database is created and fully populated, you can edit the line below in `rx_api.py` and change 'D001249' and 'may_prevent' to any combination of RxClass ID and relationship.

```
rxclass_response = rxapi_get_requestor(rxclass_getclassmember_payload('D001249','may_prevent'))
```

### Working with RxClass

You can check out this [RxClass tutorial from National Library of Medicine (NLM)](https://www.nlm.nih.gov/research/umls/user_education/quick_tours/RxClass/RxClass_Searching.html).

## Key files

### Entry point
- `rx_api.py` - this is the main script that runs through the MDT workflow

### Data readers
- `rxnorm_data_reader.py` - gets current RxNorm data tables from NLM and stores in local database
- `meps_data_reader.py` - gets MEPS DAT file, converts to data frame, and stores in local database

### SQL files
- `rxcui_ndc.sql` - creates a view from the RxNorm tables which goes from ingredient TTY RXCUIs (IN/MIN) -> product TTY RXCUIs (SCD/GPCK/SBD/BPC) -> NDC and also includes dose form (DF) information for each product
- `meps_rxcui.py` - merges the MEPS prescriptions table and demographics table

### Config/utility files
- `confing_mdt.py` - configuration file
- `mdt_functions.py` - contains a lot of important functions used in other parts of MDT
- `meps_lists.py` - used to convert the DAT file to a dataframe

## Database

MDT.db is a SQLite database that gets generated by the data reader scripts (`rxnorm_data_reader.py` and `meps_data_reader.py`)

### RxNorm tables

- `rxnconso`
- `rxnsat`
- `rxnrel`
- `rxcui_ndc` - this table/view is generated by the 

### MEPS tables

- `meps_prescription`
- `meps_demographics`
- `meps_region`
- `meps_reference`
